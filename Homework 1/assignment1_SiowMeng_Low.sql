-- Task 1

SELECT
  SURNAME,
  DEPT_ID
FROM
  STAFF
WHERE
  START_DATE = '01.01.2016' AND SALARY > 3500
ORDER BY
  SURNAME

/*
  	surname	dept_id
1	Cortez	1
2	Lawrence	3
3	Mullins	3
4	Rowe	1
*/
  
-- Task 2

SELECT
  SURNAME,
  DEPT_ID
FROM
  STAFF
WHERE
  (START_DATE = '01.01.2016' AND SALARY <= 3500) OR (START_DATE <> '01.01.2016')
ORDER BY
  SURNAME

/*
  	surname	dept_id
1	Anderson	1
2	Chapman	2
3	Cunningham	1
4	Harper	4
5	Hines	2
6	Lamb	1
7	Love	3
8	Marsh	4
9	Matthews	4
10	Patterson	2
11	Patton	2
12	Pena	2
13	Pierce	3
14	Russell	1
15	Tucker	2
16	Vasquez	3
*/

-- Task 3

SELECT
  DEPT_ID,
  COUNT(*) AS EMPLOYEES,
  AVG(SALARY) AS AVG_SALARY
FROM
  STAFF
GROUP BY
  DEPT_ID
HAVING
  COUNT(*) >= 4

/*
  	dept_id	employees	avg_salary
1	1	6	3075
2	3	5	5905
3	2	6	3850
*/
  
-- Task 4

SELECT
  DEPT.COLOUR AS COLOUR,
  AVG(SALARY) AS AVG_SALARY
FROM
  STAFF
LEFT JOIN
  DEPT ON STAFF.DEPT_ID = DEPT.ID
GROUP BY
  DEPT.COLOUR

/*
  	colour	avg_salary
1	blue	3133,3333333333333333
2	red	4784,0909090909090909
*/
  
-- Task 5

SELECT
  STAFF.NAME,
  STAFF.SURNAME,
  STAFF.BOSS_ID
FROM
  STAFF
LEFT OUTER JOIN
  STAFF AS BOSSES ON STAFF.BOSS_ID = BOSSES.ID
WHERE BOSSES.ID IS NULL

/*
  	name	surname	boss_id
1	Dora	Marsh	212
2	Ed	Vasquez	199
3	Fredrick	Mullins	212
4	Eddie	Patterson	500
*/

-- Task 6

SELECT
  DATEPART(YYYY, CREATIONDATE) AS CREATION_YEAR,
  SUM(REPUTATION) AS TOTAL_REPUTATION,
  AVG(AGE) AS AVG_AGE,
  COUNT(ID) AS USER_COUNT
FROM
  USERS
WHERE
  WEBSITEURL <> '' AND LOCATION LIKE '%London%'
GROUP BY
  DATEPART(YYYY, CREATIONDATE)

/*
CREATION_YEAR	TOTAL_REPUTATION	AVG_AGE	USER_COUNT
2008	3240170	37	286
2009	3039936	35	784
2010	2027993	34	933
2011	2187434	33	1209
2012	988975	32	1244
2013	600978	32	1245
2014	105228	31	992
2015	82411	30	581
2016	8494	32	391
*/


